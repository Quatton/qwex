modules:
  code:
    uses: ./modules/code.yaml
  lifecycle:
    uses: ./modules/lifecycle.yaml
tasks:
  init:
    cmd: |
      {{ code.prepare }}

      if [ ! -d ".venv" ]; then
        uv venv
      fi
      source .venv/bin/activate
      uv sync
  run:
    cmd: |
      {{ code.push }}

      {{ lifecycle.submit.inline({
        "init": tasks.init,
        "main": "$@",
        "cleanup": ""
      }) }}

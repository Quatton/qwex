name: hello-world

modules:
  log: 
    source: std/log
  steps:
    source: std/steps

vars:
  first_var: "This is a variable defined at the module level."

tasks:
  greet:
    run: |
      echo "Hello, World!"
  debug:
    run: |
      {{ log.debug }} "Debugging Hello World Module"
  say:
    vars:
      message: "Hello from Hello World Module!"
      times: 1
      compile_time_var: "This get inlined at compile time. and can be overridden. It's also scoped"
    run: |
      # using $ in command is raw by default. You don't need to escape it.
      echo "Compile Time Var: {{ compile_time_var }}"
      for i in $(seq 1 {{ times }}); do
        echo "{{ message }}"
      done
  debug-vars:
    uses: log.debug
    with:
      - "Debugging Hello World Module with Variables"
      - "Module Name: {{ module_name }}"
  runstep:
    run: |
      {{ steps.compose }} "Greet Step" "{{ greet }}"
      {{ steps.compose }} "Debug Step" "{{ debug }}"
  runsteps-vars:
    uses: steps.compose
    with:
      - name: "Greet Step"
        run: "{{ greet }}"
      - name: "Debug Step"
        run: "{{ debug }}"
        with:
          - "This is a step using log.debug directly."
  vars-after-vars:
    vars:
      second_var: "{{ first_var }} And this is another variable defined after."
    run: |
      echo "{{ second_var }}"